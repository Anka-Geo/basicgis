!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AnkaSoftText=e():t.AnkaSoftText=e()}(window,(function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=14)}({14:function(t,e,n){"use strict";function o(t){this.text=t,this.say=0,this.pos={x:0,y:0}}function i(t){if(i._instances.push(this),this.objects=[],AnkaPanAPI.PanoPlugin.apply(this,[]),this._zoomLevels=[.6,.3,.1],this.texts=[],this.ClassInstance=i,this.initialOptions=t,t)for(var e in t)this["_"+e]=t[e];this.object3ds=[],this.isDirty=!0}n.r(e),n.d(e,"SoftTextPlugin",(function(){return i})),n.d(e,"SoftText",(function(){return o})),o.prototype={constructor:o,draw:function(t,e,n,o){var i=this.pos;if(!(i.z>=1||i.x<0||i.x>n||i.y<0||i.y>o)){this.say++,t.font="14px Arial",t.fillStyle="white";var s=t.measureText(e.text).width,r=this.pos.x-.5*s,a=this.pos.y+7;t.lineWidth=3,this.text=e.text,t.strokeText(e.text,r+14,a-14),t.fillText(e.text,r+14,a-14)}},renderToPos:function(t,e,n){this.pos=function(t,e,n,o){var i=new THREE.Vector3;return i.setFromMatrixPosition(t.matrixWorld),i.project(e),i.x=Math.round((i.x+1)*n),i.y=Math.round((1-i.y)*o),{x:i.x,y:i.y,z:i.z}}(t.obj,t.cam,e,n)}},i.prototype=Object.create(AnkaPanAPI.PanoPlugin.prototype),i.prototype.constructor=i,i._instances=[],i.prototype.prepare=function(){var t=AnkaPanAPI.PanoGL;this.baseObject.addEvent(t.RESIZE,this,this.onResize);var e=document.createElement("canvas"),n=e.getContext("2d");n.id="softTextRender";var i=e.style;i.position="absolute",i.top="0px",i.left="0px",i.pointerEvents="none",i.backgroundColor="transparent",this.canvas=e,this.context=n,this.texts.push(new o("[SoftText]")),"complete"===document.readyState?this.addElementToBody():window.addEventListener("load",this.addElementToBody.bind(this)),this.baseObject.addEvent(AnkaPanAPI.PanoGL.POST_RENDER,this,this.onPostRender)},i.prototype.onPostRender=function(t){this.update()},i.prototype.addElementToBody=function(){if(this.baseObject.contentDV){this.canvas.parentElement!==this.baseObject.contentDV&&this.baseObject.contentDV.appendChild(this.canvas);var t=this;setTimeout((function(){t.onResize()}),100)}else setTimeout(this.addElementToBody.bind(this),100)},i.prototype.onResize=function(t){this.canvas.width=this.baseObject.stageWidth,this.canvas.height=this.baseObject.stageHeight},i.prototype.addObject3D=function(t,e,n){var i=this.objects.indexOf(t);if(-1===i){this.objects.push(t);var s=new o(n);this.object3ds.push({cam:e,obj:t,text:n,softtext:s})}else this.object3ds[i].text=n},i.prototype.removeObject3D=function(t){var e=this.objects.indexOf(t);e>-1&&(this.objects.splice(e,1),this.object3ds.splice(e,1))},i.prototype.update=function(){var t=this.context,e=this.baseObject.stageWidth,n=this.baseObject.stageHeight,o=.5*e,i=.5*n;t.clearRect(0,0,e,n);for(var s=this.object3ds,r=0;r<s.length;r++){var a=s[r].softtext;a.renderToPos(s[r],o,i),a.draw(t,s[r],e,n)}this.isDirty=!1}}})}));